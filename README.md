# README

## Автор

**Щербаков Артём Юрьевич**, группа **БПИ-244-1**, вариант **5-BS**.

---

## Общая структура меню

1. **Просмотреть список городов**
2. **Информация о городе**
3. **Города на карте**
4. **Добавить город**
5. **Редактировать город**
6. **Удалить город**
7. **Просмотреть пропущенные строки** (в случае наличия)
8. **Ввести новые данные**
9. **Сохранить**
10. **Выйти**

---

## Описание функционала

### 1. Просмотр введенных данных о городах

- Данные отображаются в табличном виде.
- Включает название города, страну, население, координаты и маркер.

### 2. Информация о городе

- Подробная информация о выбранном городе.
- Подгрузка географических спецификаций и текущей погоды по координатам.
- Вывод данных по API-запросу происходит на местном языке

### 3. Города на карте

- Вывод карты в формате ASCII с маркерами городов.
- Маркеры соответствуют городам из списка.

### 4. Добавление города

- Добавление нового города в данные программы.
- В случае совпадения с географическим объектом предлагаются координаты.

### 5. Редактирование города

- Редактирование данных о городе.
- Автозаполнение полей ввода прошлыми данными при нажатии `Enter`.

### 6. Удаление города

- Удаление города из данных программы без подтверждения.

### 7. Просмотр пропущенных строк

- Отображается только при наличии необработанных строк.
- Необработанной считается строка с ошибкой в данных (например, `"latitude": 35.6w895`).

### 8. Ввод новых данных

- Загрузка данных из нового файла без сохранения предыдущих данных.

### 9. Сохранение

- Сохранение текущих данных программы в файл без выхода из программы.

### 10. Выход

- Выход из программы без сохранения данных.

---

## Инструкция по работе с приложением

1. **Запустите приложение**.
2. **Введите путь к файлу**:
   - Если файл не существует, программа поругается и попросит новый файл.
3. **Выберите формат входных данных**:
   - Поддерживаются форматы **JSON** и **CSV**.
   - В случае ошибки парсинга:
     - Для CSV: программа скушает валидные данные, пропустит некорректные строки и предложит просмотреть их.
     - Для JSON: программа отклонит файл, если в каком-либо объекте допущена ошибка приведения типа.
   - Отсутствие координат приводит к пропуску строки (CSV) или ошибке сериализации (JSON).
4. **Работа с интерфейсом**:
   - **Автозаполнение**: При вводе данных с реализацией автозаполнения - `"Введите новое название города: (Нью-Йорк):"` - нажмите `Enter`, чтобы использовать значение в скобках.
   - **Множественный выбор**: Используйте стрелки `Вверх` и `Вниз` для навигации и `Enter` для выбора.
5. **Сохранение и выход**:
   - Для сохранения данных выберите пункт **"Сохранить"**.
   - Для выхода без сохранения выберите пункт **"Выйти"** (с подтверждением).
   - Если файл был перемещен во время работы программы, будет создан новый файл с исходным именем.

---

## Логика работы программы

### Основные компоненты:

- **CityCollection**:
  - Содержит базовые методы для работы с коллекцией городов (добавление, удаление).
- **CityManager**:
  - Отвечает за сложные операции с коллекцией (редактирование, добавление с проверкой данных).
- **CityDisplay**:
  - Отвечает за отображение данных (таблицы, списки, карты).
- **GEOCODING**:
  - Библиотека для работы с API геолокации и погоды.
- **PARSING**:
  - Предоставляет методы для парсинга, ввода и сохранения данных в форматах JSON и CSV.
- **Program**:
  - Основной класс, реализующий меню и управление программой.

---

## Формат входных данных

### CSV

### Ожидаемая структура файла:

Name,Country,Population,Latitude,Longitude,Marker  
Токио,Япония,13929286,35.6895,139.6917,1  
Москва,Россия,12655050,55.7558,37.6176,2  
Нью-Йорк,США,8419600,40.7128,-74.006,*  
Лондон,Великобритания,8900000,51.5074,-0.1278,*  



- **Marker** — необязательное поле, используемое для отрисовки городов на карте. По умолчанию заполняется автоматически.

### JSON

### Ожидаемая структура файла:

```json
[
  {
    "name": "Токио",
    "country": "Япония",
    "population": 13929286,
    "latitude": 35.6895,
    "longitude": 139.6917
  }
]
```

## Замечания

- Многие сложные конструкции в коде - дело рук конфига (смотри alibi/адекватный читаемый код.png и alibi/долбанный конфиг.png)
